<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Video Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    keyframes: {
                        floaty: {
                            "0%, 100%": { transform: "translateY(0px)" },
                            "50%": { transform: "translateY(-6px)" }
                        }
                    },
                    animation: {
                        floaty: "floaty 3.5s ease-in-out infinite"
                    }
                }
            }
        };
    </script>
</head>

<body class="min-h-screen bg-slate-950 text-slate-100">
    <div class="pointer-events-none fixed inset-0 overflow-hidden">
        <div class="absolute -top-24 -left-24 h-72 w-72 rounded-full bg-fuchsia-500/20 blur-3xl"></div>
        <div class="absolute top-1/3 -right-24 h-72 w-72 rounded-full bg-cyan-400/20 blur-3xl"></div>
        <div class="absolute -bottom-24 left-1/3 h-72 w-72 rounded-full bg-emerald-400/15 blur-3xl"></div>
    </div>

    <div class="relative mx-auto flex min-h-screen max-w-5xl items-center px-4 py-10">
        <div class="w-full">
            <div class="mb-8">
                <div
                    class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-slate-200">
                    <span class="h-2 w-2 rounded-full bg-emerald-400 animate-pulse"></span>
                    YOLOv8 + Video Attribute Pipeline
                </div>

                <h1 class="mt-4 text-3xl font-bold tracking-tight sm:text-4xl">
                    Upload a video & get detection details
                </h1>
                <p class="mt-2 max-w-2xl text-slate-300">
                    Drag & drop a video, click analyze, and you’ll get metadata + model results + an annotated output
                    video.
                </p>
            </div>

            {% with messages = get_flashed_messages() %}
            {% if messages %}
            <div class="mb-6 rounded-xl border border-red-500/30 bg-red-500/10 px-4 py-3 text-sm text-red-200">
                {{ messages[0] }}
            </div>
            {% endif %}
            {% endwith %}

            <form id="uploadForm" action="/analyze" method="POST" enctype="multipart/form-data"
                class="group rounded-2xl border border-white/10 bg-white/5 p-6 shadow-xl shadow-black/30 backdrop-blur">
                <div id="dropzone" class="relative flex flex-col items-center justify-center rounded-2xl border border-dashed border-white/20 bg-gradient-to-b from-white/5 to-white/0 px-6 py-10 transition
                   hover:border-cyan-300/60 hover:bg-white/5">
                    <div class="absolute inset-0 rounded-2xl opacity-0 transition group-hover:opacity-100">
                        <div
                            class="absolute inset-0 rounded-2xl bg-gradient-to-r from-cyan-400/10 via-fuchsia-400/10 to-emerald-400/10">
                        </div>
                    </div>

                    <div class="relative flex flex-col items-center">
                        <!-- Upload Icon -->
                        <div
                            class="mb-4 rounded-2xl border border-white/10 bg-white/5 p-4 shadow-lg shadow-black/20 animate-floaty">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="none">
                                <path d="M12 16V4m0 0 4 4m-4-4-4 4" stroke="currentColor" stroke-width="1.8"
                                    stroke-linecap="round" stroke-linejoin="round" />
                                <path
                                    d="M20 16.5a4.5 4.5 0 0 0-2.38-3.95A6 6 0 0 0 6.2 13.3 3.5 3.5 0 0 0 6.5 20H18a4 4 0 0 0 2-3.5Z"
                                    stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                        </div>

                        <p class="text-lg font-semibold">Drop your video here</p>
                        <p class="mt-1 text-sm text-slate-300">or click to browse (mp4, mov, avi, mkv, webm)</p>

                        <input id="fileInput" name="video" type="file" accept="video/*"
                            class="absolute inset-0 h-full w-full cursor-pointer opacity-0" />
                    </div>
                </div>

                <div class="mt-5 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                    <div class="flex items-center gap-3">
                        <div class="rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-200">
                            <span class="text-slate-400">Selected:</span>
                            <span id="fileName" class="ml-1 font-medium">None</span>
                        </div>

                        <div id="badge"
                            class="hidden rounded-xl border border-emerald-400/30 bg-emerald-400/10 px-3 py-2 text-sm text-emerald-200">
                            Ready
                        </div>
                    </div>

                    <button id="submitBtn" type="submit" class="inline-flex items-center justify-center gap-2 rounded-xl bg-white px-4 py-2.5 text-sm font-semibold text-slate-950
                     transition hover:bg-cyan-200 active:scale-[0.98] disabled:cursor-not-allowed disabled:opacity-50"
                        disabled>
                        <span id="btnText">Analyze Video</span>
                        <svg id="btnIcon" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24"
                            fill="none">
                            <path d="M5 12h14M13 5l7 7-7 7" stroke="currentColor" stroke-width="1.8"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>

                        <svg id="spinner" class="hidden h-4 w-4 animate-spin" viewBox="0 0 24 24" fill="none">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                            </circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 0 1 8-8v4a4 4 0 0 0-4 4H4z">
                            </path>
                        </svg>
                    </button>
                </div>

                <p class="mt-4 text-xs text-slate-400">
                    Tip: First run may take longer (models download & cache). After that, it’s faster.
                </p>
            </form>
        </div>
    </div>

    <script>
        const input = document.getElementById("fileInput");
        const fileName = document.getElementById("fileName");
        const submitBtn = document.getElementById("submitBtn");
        const badge = document.getElementById("badge");
        const dropzone = document.getElementById("dropzone");

        const btnText = document.getElementById("btnText");
        const btnIcon = document.getElementById("btnIcon");
        const spinner = document.getElementById("spinner");

        function setReadyState(file) {
            if (file) {
                fileName.textContent = file.name;
                submitBtn.disabled = false;
                badge.classList.remove("hidden");
            } else {
                fileName.textContent = "None";
                submitBtn.disabled = true;
                badge.classList.add("hidden");
            }
        }

        input.addEventListener("change", (e) => {
            setReadyState(e.target.files[0]);
        });

        ["dragenter", "dragover"].forEach((evt) => {
            dropzone.addEventListener(evt, (e) => {
                e.preventDefault();
                dropzone.classList.add("ring-2", "ring-cyan-300/60");
            });
        });

        ["dragleave", "drop"].forEach((evt) => {
            dropzone.addEventListener(evt, (e) => {
                e.preventDefault();
                dropzone.classList.remove("ring-2", "ring-cyan-300/60");
            });
        });

        dropzone.addEventListener("drop", (e) => {
            const file = e.dataTransfer.files && e.dataTransfer.files[0];
            if (file) {
                const dt = new DataTransfer();
                dt.items.add(file);
                input.files = dt.files;
                setReadyState(file);
            }
        });

        document.getElementById("uploadForm").addEventListener("submit", () => {
            submitBtn.disabled = true;
            btnText.textContent = "Analyzing...";
            btnIcon.classList.add("hidden");
            spinner.classList.remove("hidden");
        });
    </script>
</body>

</html>